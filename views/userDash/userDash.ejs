<div id="userDash">
  <div class="dashContent">
    <div>
     
      <%if(typeof user =='object'&& user){%>

      <div class="dashHeader">
        <div class="message">
          <%if (user.images==='array' && user.images){%>
          <% for(let i = 0; i < user.images.length; i++) { %>
            <% if(user.images[i].avatarTag === true) { %>
              <img src="<%= user.images[i].thumbnailUrl %>" alt="" loading="lazy">
              <% } %>
              <% } %>
              <% }else{ %>

                <img id="toggleSettings1" src="images/hugeIcon.png" alt="" loading="lazy">
            
            <%}%>
            <h3>Welcome <%=user.firstName%>!</h3>
            <h3>Logged in as: <%=user.email%></h3>
        </div>
        </div>

      </div>

      <div class="dashBody">

      </div>
      <div class="wallet">
        <div class="jewel">*</div>
        <div class="jewel"><img src="/images/icons/1.png">12</div>
        <div class="jewel"><img src="/images/icons/2.png">6</div>
        <div class="jewel"><img src="/images/icons/3.png">55</div>
        <%- include('../wallet/walletDetails')%>

      </div>


      <%- include('../notifications/notifications',{user:user}) %>
      <%- include('../cart/cartDetails',{user:user}) %>
      <%- include('../rewards/rewardsDetails',{user:user}) %>
      <%- include('../help/help',{user:user}) %>
      <%- include('./settings/userSettings',{user:user}) %>
      <%if(user.isAdmin===true){%>
      <%- include('../admin/admin',{user:user})%>
      <%}%>
        <%}else{%>
      <div style="overflow: scroll;height:auto;">

        <h2>Login Portal</h2>
        <div id="authOptionButtons">
        <button class="authOpts" id="firstTimeYes">"This is my first time to login on this website."</button>
        <button class="authOpts" id="firstTimeNo">"I have registered and created a login on this website."</button>
       </div>
        <div class="loginFlows" id="regWindow"><%-include('../auth/register')%></div>
        <div class="loginFlows" id="loginWindow"><%-include('../auth/login')%></div>

 
      </div>

      <%}%>

            <%- include('./settings/userNav',{user:user})%>
    </div>
  </div>
</div>
<script>






  document.addEventListener('DOMContentLoaded', () => {
    let dashWindowState = null;
    const dashToggle = document.getElementById('dashToggle');
    const dashWindow = document.getElementById('userDash');
    const main = document.getElementById('main')
    dashToggle.addEventListener('click', () => {
      if (dashWindow.style.transform != "translateX(106%)") {
        dashWindow.style.transform = "translateX(106%)";

        dashToggle.innerHTML = "close";
        dashWindowState = "open"
      } else {

        dashWindow.style.transform = "translateX(0%)";
        dashToggle.innerHTML = "dashboard";
        dashWindowState = "hidden";
      }
    })
  })
  document.addEventListener('DOMContentLoaded', function() {
    function changeToLoginMethod(divId) {
        // Log the event for debugging
        console.log(event);

        // Hide both windows initially
        document.getElementById('regWindow').style.display = 'none';
        document.getElementById('loginWindow').style.display = 'none';

        // Show the relevant window based on the argument passed
        document.getElementById(divId).style.display = 'block';

        // Reset the background color of all buttons to their default
        const buttons = document.getElementById('authOptionButtons').getElementsByTagName('button');
        for (let button of buttons) {
            button.style.backgroundColor = ''; // Reset background color to default
            button.style.color = ''; // Reset background color to default
        }

        // Change the background color of the clicked button to purple
        if (event.target.tagName === 'BUTTON') {
            event.target.style.backgroundColor = 'purple';
            event.target.style.color = 'gold';
        }
    }

    // Attach the function to the global scope
    window.changeToLoginMethod = changeToLoginMethod;
});


document.addEventListener('DOMContentLoaded', () => {
    const firstTimeYes = document.getElementById('firstTimeYes');
    const firstTimeNo = document.getElementById('firstTimeNo');

    // Use closures to pass the correct argument to the function
    firstTimeYes.addEventListener('click', () => changeToLoginMethod('regWindow'));
    firstTimeNo.addEventListener('click', () => changeToLoginMethod('loginWindow'));
});


  const walletButtonControl = () => {
    const toggleAdmin = document.getElementById('toggleAdmin');
    const toggleWallet = document.getElementById('toggleWallet');
    const adminDiv = document.getElementById('admin');
    const walletDiv = document.getElementById('wallet');
    const buttonCtlGroups = [{
        button: toggleAdmin,
        div: adminDiv
      },
      {
        button: toggleWallet,
        div: walletDiv
      }
    ];
    console.log('walletButtonControl() ran');
    for (let i = 0; i < buttonCtlGroups.length; i++) {
      const btn = buttonCtlGroups[i].button;
      const div = buttonCtlGroups[i].div;
      console.log(div)
      console.log(btn)
      btn.addEventListener('click', function() {
        if (div.style.display === "block") {
          div.style.display = 'none';
        } else {
          for (let i = 0; i < buttonCtlGroups.length; i++) {
            buttonCtlGroups[i].div.style.display = 'none'
          }
          div.style.display = 'block';
        }
      });
    }
  }
  document.addEventListener('DOMContentLoaded', walletButtonControl);
</script>